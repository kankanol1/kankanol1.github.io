<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="../../../../img/favicon.ico" type="image/x-icon" />

    <title>童话镇</title>
    <script src="../../../js/jquery-1.12.4.js"></script>
    <!--<script src="js/lrctest.js" type="text/javascript"></script>-->

    <style>
        body{
            background-image: url("00.jpeg");
            /*background-repeat: no-repeat;*/
            background-size: 100% auto;

        }
        .box{
            margin: 0 auto;
            text-align: center;
        }
        #lyric{
            /*background-color: #f0ad4e;*/
            text-align: center;
            font-size: 20px;
            height: 30px;
            /*color: pink;*/
            color: #dcf8ff;
            text-shadow: 5px 5px 5px #0000CD;
        }
        #mp{
            width: 300px;
            height: 100px;
            margin-bottom: 100px;
        }
        h1{
            /*font-size: 50px;*/
            color: #ff5fc4;
        }
        .name{
            font-size: 20px;
            color: #fff;
            margin-bottom: 35%;
        }
    </style>
</head>
<body>

<div class="box">
    <h1>童话镇</h1>
    <p class="name">陈一发</p>
    <audio src="../mp3/tonghuzzhen.mp3"  autoplay="autoplay" controls id="mp">
        抱歉你的浏览器版本out了，去升级吧
    </audio>
    <div id="lyric"></div>
</div>
<script>

    var str = '[00:00.73]童话镇 - 陈一发儿\n' +
        '[00:01.50]词：竹君\n' +
        '[00:01.64]曲：暗杠\n' +
        '[00:01.79]编曲：暗杠\n' +
        '[00:02.52]\n' +
        '[00:23.20]听说白雪公主在逃跑\n' +
        '[00:25.67]\n' +
        '[00:26.60]小红帽在担心大灰狼\n' +
        '[00:29.14]\n' +
        '[00:29.91]听说疯帽喜欢爱丽丝\n' +
        '[00:32.73]\n' +
        '[00:33.33]丑小鸭会变成白天鹅\n' +
        '[00:36.13]\n' +
        '[00:36.79]听说彼得潘总长不大\n' +
        '[00:39.46]\n' +
        '[00:40.20]杰克他有竖琴和魔法\n' +
        '[00:42.94]\n' +
        '[00:43.58]听说森林里有糖果屋\n' +
        '[00:46.32]\n' +
        '[00:46.83]灰姑娘丢了心爱的玻璃鞋\n' +
        '[00:50.08]\n' +
        '[00:50.64]只有睿智的河水知道\n' +
        '[00:53.16]\n' +
        '[00:53.80]白雪是因为贪玩跑出了城堡\n' +
        '[00:57.35]小红帽有件抑制自己\n' +
        '[00:59.93]\n' +
        '[01:00.77]变成狼的大红袍\n' +
        '[01:03.93]总有一条蜿蜒在童话镇里七彩的河\n' +
        '[01:11.02]沾染魔法的乖张气息\n' +
        '[01:14.56]却又在爱里曲折\n' +
        '[01:17.43]\n' +
        '[01:17.93]川流不息扬起水花\n' +
        '[01:20.93]又卷入一帘时光入水\n' +
        '[01:24.17]\n' +
        '[01:24.72]让所有很久很久以前\n' +
        '[01:28.24]都走到幸福结局的时刻\n' +
        '[01:31.74]\n' +
        '[01:47.48]听说睡美人被埋藏\n' +
        '[01:49.91]\n' +
        '[01:50.53]小人鱼在眺望金殿堂\n' +
        '[01:53.31]\n' +
        '[01:53.85]听说阿波罗变成金乌\n' +
        '[01:56.80]\n' +
        '[01:57.33]草原有奔跑的剑齿虎\n' +
        '[02:00.17]\n' +
        '[02:00.77]听说匹诺曹总说着谎\n' +
        '[02:03.50]\n' +
        '[02:04.31]侏儒怪拥有宝石满箱\n' +
        '[02:07.14]\n' +
        '[02:07.81]听说悬崖有棵长生树\n' +
        '[02:10.40]\n' +
        '[02:11.08]红鞋子不知疲倦地在跳舞\n' +
        '[02:14.64]只有睿智的河水知道\n' +
        '[02:17.32]\n' +
        '[02:17.85]睡美人逃避了生活的煎熬\n' +
        '[02:21.34]小人鱼把阳光抹成眼影\n' +
        '[02:24.23]\n' +
        '[02:24.74]投进泡沫的怀抱\n' +
        '[02:27.81]总有一条蜿蜒在童话镇里七彩的河\n' +
        '[02:34.75]\n' +
        '[02:35.27]沾染魔法的乖张气息\n' +
        '[02:38.65]却又在爱里曲折\n' +
        '[02:41.50]\n' +
        '[02:42.01]川流不息扬起水花\n' +
        '[02:44.98]又卷入一帘时光入水\n' +
        '[02:48.33]\n' +
        '[02:48.87]让所有很久很久以前\n' +
        '[02:52.30]都走到幸福结局的时刻\n' +
        '[02:55.57]总有一条蜿蜒在童话镇里梦幻的河\n' +
        '[03:01.94]\n' +
        '[03:02.61]分隔了理想分隔现实\n' +
        '[03:05.96]又在前方的山口汇合\n' +
        '[03:08.86]\n' +
        '[03:09.36]川流不息扬起水花\n' +
        '[03:12.44]又卷入一帘时光入水\n' +
        '[03:15.74]\n' +
        '[03:16.25]让所有很久很久以前\n' +
        '[03:19.66]都走到幸福结局的时刻\n' +
        '[03:22.73]又陌生\n' +
        '[03:24.48]啊~~啊~~啊~\n' +
        '[10:00.00]完～';
    var arr = str.split('\n');



    $(document).ready(function () {
        var lrc = []; //创建歌词数组;
        lrc = arr;
        var myAudio = $("audio")[0];
        var result = [];
        getLrc();


        function getLrc() {
            var timeReg = /\[\d{2}:\d{2}\.\d{2}\]/g;//匹配时间的正则表达式

            for (var i=0;i<lrc.length;i++) {
                var time = lrc[i].match(timeReg); //获取歌词里的时间
                var value = lrc[i].replace(timeReg, ""); //获取纯歌词文本
                for (var j=0;j<time.length-1;j++ ) {
                    var t = time[j].slice(1, -1).split(":"); //t[0]分钟，t[1]秒
                    var timeArr = parseInt(t[0], 10) * 60 + parseFloat(t[1]);
                    result.push([timeArr, value]);//以[时间(秒)，歌词]的形式存进result
                }
            }
            setInterval(showLrc, 200);//设置定时，每200毫秒更新一下
            // console.log(result);
        }

        function showLrc() {
            var curTime = myAudio.currentTime;//获取当前的播放时间
            for (var i = 0; i < result.length; i++) {
                if ((curTime >result[i][0])&&(curTime<result[i+1][0])) {
                    //播放时间大于对应歌词时间小于下一句歌词时间就显示当前歌词
                    document.getElementById("lyric").innerHTML = result[i][1];
                    break;//找到对应歌词就停，不停的话，呵呵。。。
                }
            }
        }
    })
</script>

</body>
</html>